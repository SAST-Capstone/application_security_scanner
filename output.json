{"errors": [], "paths": {"_comment": "<add --verbose for a list of skipped paths>", "scanned": ["/root/code/vulpy/.gitignore", "/root/code/vulpy/LICENSE", "/root/code/vulpy/README.rst", "/root/code/vulpy/bad/.gitignore", "/root/code/vulpy/bad/api_list.py", "/root/code/vulpy/bad/api_post.py", "/root/code/vulpy/bad/brute.py", "/root/code/vulpy/bad/csp.txt", "/root/code/vulpy/bad/db.py", "/root/code/vulpy/bad/db_init.py", "/root/code/vulpy/bad/libapi.py", "/root/code/vulpy/bad/libmfa.py", "/root/code/vulpy/bad/libposts.py", "/root/code/vulpy/bad/libsession.py", "/root/code/vulpy/bad/libuser.py", "/root/code/vulpy/bad/mod_api.py", "/root/code/vulpy/bad/mod_csp.py", "/root/code/vulpy/bad/mod_hello.py", "/root/code/vulpy/bad/mod_mfa.py", "/root/code/vulpy/bad/mod_posts.py", "/root/code/vulpy/bad/mod_user.py", "/root/code/vulpy/bad/payloads/cookie.js", "/root/code/vulpy/bad/payloads/hello.html", "/root/code/vulpy/bad/payloads/keylogger.js", "/root/code/vulpy/bad/payloads/payload.js", "/root/code/vulpy/bad/static/background.png", "/root/code/vulpy/bad/static/background.xcf", "/root/code/vulpy/bad/static/font-awesome.min.css", "/root/code/vulpy/bad/static/w3.css", "/root/code/vulpy/bad/templates/csp.html", "/root/code/vulpy/bad/templates/footer.html", "/root/code/vulpy/bad/templates/head.html", "/root/code/vulpy/bad/templates/messages.html", "/root/code/vulpy/bad/templates/mfa.disable.html", "/root/code/vulpy/bad/templates/mfa.enable.html", "/root/code/vulpy/bad/templates/navbar.html", "/root/code/vulpy/bad/templates/posts.view.html", "/root/code/vulpy/bad/templates/user.chpasswd.html", "/root/code/vulpy/bad/templates/user.create.html", "/root/code/vulpy/bad/templates/user.login.html", "/root/code/vulpy/bad/templates/user.login.mfa.html", "/root/code/vulpy/bad/templates/welcome.html", "/root/code/vulpy/bad/vulpy-ssl.py", "/root/code/vulpy/bad/vulpy.py", "/root/code/vulpy/good/.gitignore", "/root/code/vulpy/good/bad-passwords.txt", "/root/code/vulpy/good/csp.txt", "/root/code/vulpy/good/cutpasswd.py", "/root/code/vulpy/good/db_init.py", "/root/code/vulpy/good/httpbrute.py", "/root/code/vulpy/good/leaked_passwords.txt", "/root/code/vulpy/good/libapi.py", "/root/code/vulpy/good/libmfa.py", "/root/code/vulpy/good/libposts.py", "/root/code/vulpy/good/libsession.py", "/root/code/vulpy/good/libuser.py", "/root/code/vulpy/good/mod_api.py", "/root/code/vulpy/good/mod_csp.py", "/root/code/vulpy/good/mod_hello.py", "/root/code/vulpy/good/mod_mfa.py", "/root/code/vulpy/good/mod_posts.py", "/root/code/vulpy/good/mod_user.py", "/root/code/vulpy/good/mod_welcome1.py", "/root/code/vulpy/good/payloads/cookie.js", "/root/code/vulpy/good/payloads/hello.html", "/root/code/vulpy/good/payloads/keylogger.js", "/root/code/vulpy/good/payloads/payload.js", "/root/code/vulpy/good/static/background.png", "/root/code/vulpy/good/static/background.xcf", "/root/code/vulpy/good/static/font-awesome.min.css", "/root/code/vulpy/good/static/w3.css", "/root/code/vulpy/good/templates/csp.html", "/root/code/vulpy/good/templates/footer.html", "/root/code/vulpy/good/templates/head.html", "/root/code/vulpy/good/templates/messages.html", "/root/code/vulpy/good/templates/mfa.disable.html", "/root/code/vulpy/good/templates/mfa.enable.html", "/root/code/vulpy/good/templates/navbar.html", "/root/code/vulpy/good/templates/posts.view.html", "/root/code/vulpy/good/templates/user.chpasswd.html", "/root/code/vulpy/good/templates/user.create.html", "/root/code/vulpy/good/templates/user.login.html", "/root/code/vulpy/good/templates/user.login.mfa.html", "/root/code/vulpy/good/templates/welcome.html", "/root/code/vulpy/good/vulpy-ssl.py", "/root/code/vulpy/good/vulpy.py", "/root/code/vulpy/install-on-kali.sh", "/root/code/vulpy/owasp-asvs-4.0.csv", "/root/code/vulpy/requirements.txt", "/root/code/vulpy/utils/aes-decrypt.py", "/root/code/vulpy/utils/aes-encrypt.py", "/root/code/vulpy/utils/ca-create.py", "/root/code/vulpy/utils/ca-csr-create.py", "/root/code/vulpy/utils/ca-csr-load.py", "/root/code/vulpy/utils/crack-cvv.py", "/root/code/vulpy/utils/crack-hash.py", "/root/code/vulpy/utils/fernet-generate-key.py", "/root/code/vulpy/utils/generate_bad_passwords.py", "/root/code/vulpy/utils/hashfile.py", "/root/code/vulpy/utils/hmac_generate.py", "/root/code/vulpy/utils/httpbrute.py", "/root/code/vulpy/utils/luncheck.py", "/root/code/vulpy/utils/passwords.txt", "/root/code/vulpy/utils/rsa-decrypt.py", "/root/code/vulpy/utils/rsa-encrypt.py", "/root/code/vulpy/utils/rsa-keygen.py", "/root/code/vulpy/utils/rsa-sign.py", "/root/code/vulpy/utils/rsa-verify.py", "/root/code/vulpy/utils/scrypt-crack.py", "/root/code/vulpy/utils/scrypt-generate.py", "/root/code/vulpy/utils/scrypt-verify.py", "/root/code/vulpy/utils/skey.py"]}, "results": [{"check_id": "scanner_code.scanner_rules.flask.security.xss.audit.template-unescaped-with-safe", "end": {"col": 32, "line": 8, "offset": 371}, "extra": {"engine_kind": "OSS", "fingerprint": "53141a5c0b7bba500d2edef55b9667d0eedeaa32afbcdad5d3043bd2c4ba5c75395891a6af7f1916316c2782d29359ba8e4ed13097c8851f47aab5daf9f56c7c_0", "is_ignored": false, "lines": "        <p>{{ message | safe }}</p>", "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$1": {"abstract_content": " }}", "end": {"col": 32, "line": 8, "offset": 371}, "start": {"col": 29, "line": 8, "offset": 368}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/templates/messages.html", "start": {"col": 12, "line": 8, "offset": 351}}, {"check_id": "scanner_code.scanner_rules.flask.security.xss.audit.template-unescaped-with-safe", "end": {"col": 57, "line": 23, "offset": 801}, "extra": {"engine_kind": "OSS", "fingerprint": "63621d2f0ad7c6b446181d38b592c4ae44f1960182624b8e8af71e9545fc1c2bee7cd8bf613b501435097a17c4b58583b155271d9b4ce2c825312bd10a8d3b40_0", "is_ignored": false, "lines": "          <li><span class=\"w3-h3\">{{ post.text | safe }}</span></li>", "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$1": {"abstract_content": " }}", "end": {"col": 57, "line": 23, "offset": 801}, "start": {"col": 54, "line": 23, "offset": 798}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/templates/posts.view.html", "start": {"col": 35, "line": 23, "offset": 779}}, {"check_id": "scanner_code.scanner_rules.flask.security.xss.audit.template-unescaped-with-safe", "end": {"col": 32, "line": 8, "offset": 371}, "extra": {"engine_kind": "OSS", "fingerprint": "4bfb68f007c84e258caa8753119c9903e09ca6d0dfb5937676bb517fe3384bc6e2b61ba9b4f19f4288f2a19a33e3be1e9116fd3b495cac9d6a0268ed14f3b1a0_0", "is_ignored": false, "lines": "        <p>{{ message | safe }}</p>", "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$1": {"abstract_content": " }}", "end": {"col": 32, "line": 8, "offset": 371}, "start": {"col": 29, "line": 8, "offset": 368}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/templates/messages.html", "start": {"col": 12, "line": 8, "offset": 351}}, {"check_id": "scanner_code.scanner_rules.flask.security.xss.audit.template-unescaped-with-safe", "end": {"col": 57, "line": 23, "offset": 801}, "extra": {"engine_kind": "OSS", "fingerprint": "3582a334c3c3ef5adbe2a6bbf92e30792b1896456ffabba2e738d9cb00284610bf7c6440eccf22805fd4d3888aea0a6e5c698f7022227706f4319843567a85b4_0", "is_ignored": false, "lines": "          <li><span class=\"w3-h3\">{{ post.text | safe }}</span></li>", "message": "Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$1": {"abstract_content": " }}", "end": {"col": 57, "line": 23, "offset": 801}, "start": {"col": 54, "line": 23, "offset": 798}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/templates/posts.view.html", "start": {"col": 35, "line": 23, "offset": 779}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_using_app_run_directly", "end": {"col": 87, "line": 29, "offset": 720}, "extra": {"engine_kind": "OSS", "fingerprint": "e07de9d3dc0ac4a6e4fcffc5f0f8e80e48d68a146f1fbf98a84899c4b8d039aafe4dba79a9f13b6028d8c18441dbbdbf24f758c44070af6d8ea234eb655403da_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', ssl_context=('/tmp/acme.cert', '/tmp/acme.key'))", "message": "top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-668: Exposure of Resource to Wrong Sphere"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/vulpy-ssl.py", "start": {"col": 1, "line": 29, "offset": 634}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_using_app_run_directly", "end": {"col": 72, "line": 55, "offset": 1341}, "extra": {"engine_kind": "OSS", "fingerprint": "afa48af04938dbaf59b205d541cb8b0ada13badfea0d389c128890f2b413c3083b1eb0acb836398f4618de0cc5a46a65514f09188a5c49e0fffc809c0d6412ce_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', port=5000, extra_files='csp.txt')", "message": "top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-668: Exposure of Resource to Wrong Sphere"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/vulpy.py", "start": {"col": 1, "line": 55, "offset": 1270}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_using_app_run_directly", "end": {"col": 87, "line": 29, "offset": 720}, "extra": {"engine_kind": "OSS", "fingerprint": "1b90a51e94cafd0a0d7bac175af96f51458cde04327537848e077c9b13ebe092a09b5a071d64c56d579ac4550f600341a5687a1a860da58855724085fb7dc23c_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', ssl_context=('/tmp/acme.cert', '/tmp/acme.key'))", "message": "top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-668: Exposure of Resource to Wrong Sphere"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/vulpy-ssl.py", "start": {"col": 1, "line": 29, "offset": 634}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_using_app_run_directly", "end": {"col": 72, "line": 53, "offset": 1393}, "extra": {"engine_kind": "OSS", "fingerprint": "4524c0c4ce0012d0792c1a180d37f476f64cfd3e91d18dbb458a1441682bf91a8e69da3a2dc9a3f656eeb8508fc73843cb728114accde197ad611fdf13f1092e_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', port=5001, extra_files='csp.txt')", "message": "top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-668: Exposure of Resource to Wrong Sphere"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/vulpy.py", "start": {"col": 1, "line": 53, "offset": 1322}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_hardcoded_config_SECRET_KEY", "end": {"col": 37, "line": 13, "offset": 270}, "extra": {"engine_kind": "OSS", "fingerprint": "b44d0629cb9d933a11c018868476b0389ba6432e2cd62961a8daab0478c9c0779d7856060438c3fd046f4073f22011bee75f94d5bd4d478c80fc77ec5c653d1a_0", "is_ignored": false, "lines": "app.config['SECRET_KEY'] = 'aaaaaaa'", "message": "Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://bento.dev/checks/flask/avoid-hardcoded-config/", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$M": {"abstract_content": "app", "end": {"col": 4, "line": 13, "offset": 237}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 12, "offset": 233}, "svalue_start": {"col": 7, "line": 12, "offset": 219}}, "start": {"col": 1, "line": 13, "offset": 234}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/vulpy-ssl.py", "start": {"col": 1, "line": 13, "offset": 234}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_hardcoded_config_SECRET_KEY", "end": {"col": 37, "line": 16, "offset": 351}, "extra": {"engine_kind": "OSS", "fingerprint": "bf1fe291b78b840c45222613eaae54642692c4a75e4946b4c2d7c46b0f0c6c1dedf18b3ca0440e5b72a4cb51903457404b9b66b06cd83d2e63266e069fc685c9_0", "is_ignored": false, "lines": "app.config['SECRET_KEY'] = 'aaaaaaa'", "message": "Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://bento.dev/checks/flask/avoid-hardcoded-config/", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$M": {"abstract_content": "app", "end": {"col": 4, "line": 16, "offset": 318}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 15, "offset": 314}, "svalue_start": {"col": 7, "line": 15, "offset": 300}}, "start": {"col": 1, "line": 16, "offset": 315}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/vulpy.py", "start": {"col": 1, "line": 16, "offset": 315}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_hardcoded_config_SECRET_KEY", "end": {"col": 37, "line": 13, "offset": 270}, "extra": {"engine_kind": "OSS", "fingerprint": "c241d9c162d25a8654d9d013765c9904b5e9e9ae577f23d01951f55dadbdbce5b4f36fc3c1a5e3eb1ac726fdc78389b2495e74d0596ec3aaeeceeffa82b48356_0", "is_ignored": false, "lines": "app.config['SECRET_KEY'] = 'aaaaaaa'", "message": "Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://bento.dev/checks/flask/avoid-hardcoded-config/", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$M": {"abstract_content": "app", "end": {"col": 4, "line": 13, "offset": 237}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 12, "offset": 233}, "svalue_start": {"col": 7, "line": 12, "offset": 219}}, "start": {"col": 1, "line": 13, "offset": 234}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/good/vulpy-ssl.py", "start": {"col": 1, "line": 13, "offset": 234}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.avoid_hardcoded_config_SECRET_KEY", "end": {"col": 94, "line": 17, "offset": 409}, "extra": {"engine_kind": "OSS", "fingerprint": "281286297907a0990e67fa82d7daa1ae25b93c3608664a6c8a66a3b51d83bcdb0a80f0ba76e23d2d86bb2a018aa52b61161fb7a53a7860d2aabfa4c4dd91d5d8_0", "is_ignored": false, "lines": "app.config['SECRET_KEY'] = '123aa8a93bdde342c871564a62282af857bda14b3359fde95d0c5e4b321610c1'", "message": "Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://bento.dev/checks/flask/avoid-hardcoded-config/", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#builtin-configuration-values", "https://flask.palletsprojects.com/en/1.1.x/config/?highlight=configuration#environment-and-debug-features"], "subcategory": ["audit"], "technology": ["flask"]}, "metavars": {"$M": {"abstract_content": "app", "end": {"col": 4, "line": 17, "offset": 319}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 16, "offset": 315}, "svalue_start": {"col": 7, "line": 16, "offset": 301}}, "start": {"col": 1, "line": 17, "offset": 316}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/good/vulpy.py", "start": {"col": 1, "line": 17, "offset": 316}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.debug-enabled", "end": {"col": 87, "line": 29, "offset": 720}, "extra": {"engine_kind": "OSS", "fingerprint": "97e63021086250862a331c3dc011f430437c2bdbd2cfc8c11ba05d2c1e62d6664b0dcb7e247b66d2c6dd55568d2822326a2c00c356bff7f108f8f00c3be84242_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', ssl_context=('/tmp/acme.cert', '/tmp/acme.key'))", "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-489: Active Debug Code"], "impact": "MEDIUM", "likelihood": "HIGH", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {"$APP": {"abstract_content": "app", "end": {"col": 4, "line": 29, "offset": 637}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 12, "offset": 233}, "svalue_start": {"col": 7, "line": 12, "offset": 219}}, "start": {"col": 1, "line": 29, "offset": 634}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/vulpy-ssl.py", "start": {"col": 1, "line": 29, "offset": 634}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.debug-enabled", "end": {"col": 72, "line": 55, "offset": 1341}, "extra": {"engine_kind": "OSS", "fingerprint": "905ef6c1377dc7c0915db472a8507e3896c7780a571d5020da1fafe3528c5a9d36346e84c59d0c664158e63a8b580d312a84348a9eba476e2cadf8e6f2623f5d_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', port=5000, extra_files='csp.txt')", "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-489: Active Debug Code"], "impact": "MEDIUM", "likelihood": "HIGH", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {"$APP": {"abstract_content": "app", "end": {"col": 4, "line": 55, "offset": 1273}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 15, "offset": 314}, "svalue_start": {"col": 7, "line": 15, "offset": 300}}, "start": {"col": 1, "line": 55, "offset": 1270}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/vulpy.py", "start": {"col": 1, "line": 55, "offset": 1270}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.debug-enabled", "end": {"col": 87, "line": 29, "offset": 720}, "extra": {"engine_kind": "OSS", "fingerprint": "3626f6bf4504e5445b9f55dafc4c80060f4194dfd15d54c8ba7ed305e1add3cc6bbbe1c3501746a2976172310938621b0d91c9cf3d07ff261e59880039f9ed21_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', ssl_context=('/tmp/acme.cert', '/tmp/acme.key'))", "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-489: Active Debug Code"], "impact": "MEDIUM", "likelihood": "HIGH", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {"$APP": {"abstract_content": "app", "end": {"col": 4, "line": 29, "offset": 637}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 12, "offset": 233}, "svalue_start": {"col": 7, "line": 12, "offset": 219}}, "start": {"col": 1, "line": 29, "offset": 634}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/vulpy-ssl.py", "start": {"col": 1, "line": 29, "offset": 634}}, {"check_id": "scanner_code.scanner_rules.flask.security.audit.debug-enabled", "end": {"col": 72, "line": 53, "offset": 1393}, "extra": {"engine_kind": "OSS", "fingerprint": "570a3740153fbc508bfa20b2a9fd6db8a8a5f18daf55c346e527fb7a071d8791e1f8da4bbdbec2d197805e320b2a530af28974bf404c0f6027840230b14ddc05_0", "is_ignored": false, "lines": "app.run(debug=True, host='127.0.1.1', port=5001, extra_files='csp.txt')", "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-489: Active Debug Code"], "impact": "MEDIUM", "likelihood": "HIGH", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"], "subcategory": ["vuln"], "technology": ["flask"]}, "metavars": {"$APP": {"abstract_content": "app", "end": {"col": 4, "line": 53, "offset": 1325}, "propagated_value": {"svalue_abstract_content": "Flask('vulpy')", "svalue_end": {"col": 21, "line": 16, "offset": 315}, "svalue_start": {"col": 7, "line": 16, "offset": 301}}, "start": {"col": 1, "line": 53, "offset": 1322}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/vulpy.py", "start": {"col": 1, "line": 53, "offset": 1322}}, {"check_id": "scanner_code.scanner_rules.jwt.security.jwt-python-hardcoded-secret", "end": {"col": 18, "line": 24, "offset": 448}, "extra": {"engine_kind": "OSS", "fingerprint": "403e9d2d49479d6fbe5b1212fbf4f5984df6684f867d9fdbe84707773ef9057095b395c223b044e4480a6ef2753c5d0cfc7588b08abbe6a12725a681179fff80_0", "is_ignored": false, "lines": "        }, secret, algorithm='HS256').decode()", "message": "Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "MEDIUM", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design"], "references": ["https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"], "subcategory": ["vuln"], "technology": ["jwt"]}, "metavars": {"$SECRET": {"abstract_content": "secret", "end": {"col": 18, "line": 24, "offset": 448}, "propagated_value": {"svalue_abstract_content": "'MYSUPERSECRETKEY'", "svalue_end": {"col": 28, "line": 10, "offset": 141}, "svalue_start": {"col": 10, "line": 10, "offset": 123}}, "start": {"col": 12, "line": 24, "offset": 442}}, "$X": {"abstract_content": "{'username'username'nbf'now'exp'now+not_after}", "end": {"col": 10, "line": 24, "offset": 440}, "start": {"col": 24, "line": 20, "offset": 348}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/good/libapi.py", "start": {"col": 12, "line": 24, "offset": 442}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 103, "line": 19, "offset": 549}, "extra": {"engine_kind": "OSS", "fingerprint": "68bde6c536e983ed7d80f875305752006adf44d068fa99d15bd1bd3643c7e9db3689ce8dbc69ea88ae277b8d647c3c64fe3034447b46f2f5f4d1e9a6c7aa1a18_0", "is_ignored": false, "lines": "        c.execute(\"INSERT INTO users (user, password, failures) VALUES ('%s', '%s', '%d')\" %(u, p, 0))", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 10, "line": 19, "offset": 456}, "start": {"col": 9, "line": 19, "offset": 455}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/db.py", "start": {"col": 9, "line": 19, "offset": 455}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 151, "line": 20, "offset": 545}, "extra": {"engine_kind": "OSS", "fingerprint": "3e2f23904b57ba67f37e64069f83febe567369e9b3db43102fc58ec08fbcbba774f4f56279f7ea88d3d878f21eda6d8d4eb21b949c80d5c422a07c9fb01aee0f_0", "is_ignored": false, "lines": "        c.execute(\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\" %(u, p, 0, 0, ''))", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 10, "line": 20, "offset": 404}, "start": {"col": 9, "line": 20, "offset": 403}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/db_init.py", "start": {"col": 9, "line": 20, "offset": 403}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 113, "line": 12, "offset": 315}, "extra": {"engine_kind": "OSS", "fingerprint": "65128009588c91c43c75a731d60a6f2aedcac67f72422278cf75c0b2720ef9d41ad59c5cc00fce696048f18fd07b0b853d91b58819d3ce599887d44c451a1267_0", "is_ignored": false, "lines": "    user = c.execute(\"SELECT * FROM users WHERE username = '{}' and password = '{}'\".format(username, password)).fetchone()", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 13, "line": 12, "offset": 215}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 10, "offset": 201}, "svalue_start": {"col": 9, "line": 10, "offset": 188}}, "start": {"col": 12, "line": 12, "offset": 214}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 12, "line": 12, "offset": 214}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 161, "line": 25, "offset": 668}, "extra": {"engine_kind": "OSS", "fingerprint": "65128009588c91c43c75a731d60a6f2aedcac67f72422278cf75c0b2720ef9d41ad59c5cc00fce696048f18fd07b0b853d91b58819d3ce599887d44c451a1267_1", "is_ignored": false, "lines": "    c.execute(\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\" %(username, password, 0, 0, ''))", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 6, "line": 25, "offset": 513}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 23, "offset": 506}, "svalue_start": {"col": 9, "line": 23, "offset": 493}}, "start": {"col": 5, "line": 25, "offset": 512}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 5, "line": 25, "offset": 512}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 99, "line": 53, "offset": 1301}, "extra": {"engine_kind": "OSS", "fingerprint": "65128009588c91c43c75a731d60a6f2aedcac67f72422278cf75c0b2720ef9d41ad59c5cc00fce696048f18fd07b0b853d91b58819d3ce599887d44c451a1267_2", "is_ignored": false, "lines": "    c.execute(\"UPDATE users SET password = '{}' WHERE username = '{}'\".format(password, username))", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 6, "line": 53, "offset": 1208}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 51, "offset": 1201}, "svalue_start": {"col": 9, "line": 51, "offset": 1188}}, "start": {"col": 5, "line": 53, "offset": 1207}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 5, "line": 53, "offset": 1207}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.formatted-sql-query", "end": {"col": 171, "line": 61, "offset": 1523}, "extra": {"engine_kind": "OSS", "fingerprint": "032013de185e98d74f0c1d0b8486e7971e735119608bdc8e13c777eb40032f37999367175704334cd0884179c65945983332961f4e1061d6837234ded5d9ed74_0", "is_ignored": false, "lines": "    c.execute(\"INSERT INTO users (username, password, salt, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%s', '%d', '%d', '%s')\" %(username, '', '', 0, 0, ''))", "message": "Detected possible formatted SQL query. Use parameterized queries instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/775296/mysql-parameterized-queries"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$DB": {"abstract_content": "c", "end": {"col": 6, "line": 61, "offset": 1358}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 60, "offset": 1352}, "svalue_start": {"col": 9, "line": 60, "offset": 1339}}, "start": {"col": 5, "line": 61, "offset": 1357}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/libuser.py", "start": {"col": 5, "line": 61, "offset": 1357}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.dangerous-subprocess-use-audit", "end": {"col": 86, "line": 21, "offset": 331}, "extra": {"engine_kind": "OSS", "fingerprint": "722512a28727d31d8837cecb56a2e31878292acc97ab5d6003d01e98c67e9fb6ffeb85980debf28beb0b20384dd22d133583422a022dcf25dbabf77830346e3a_0", "is_ignored": false, "lines": "    result = subprocess.run([program, username, password], stdout=subprocess.DEVNULL)", "message": "Detected subprocess function 'run' without a static string. If this data can be controlled by a malicious actor, it may be an instance of command injection. Audit the use of this call to ensure it is not controllable by an external resource. You may consider using 'shlex.escape()'.", "metadata": {"asvs": {"control_id": "5.3.8 OS Command Injection", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess", "https://docs.python.org/3/library/subprocess.html", "https://docs.python.org/3/library/shlex.html", "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"], "subcategory": ["audit"], "technology": ["python"]}, "metavars": {"$FUNC": {"abstract_content": "run", "end": {"col": 28, "line": 21, "offset": 273}, "start": {"col": 25, "line": 21, "offset": 270}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/brute.py", "start": {"col": 14, "line": 21, "offset": 259}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.dangerous-subprocess-use-tainted-env-args", "end": {"col": 58, "line": 21, "offset": 303}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "username", "location": {"end": {"col": 9, "line": 7, "offset": 84}, "path": "/root/code/vulpy/bad/brute.py", "start": {"col": 1, "line": 7, "offset": 76}}}], "taint_sink": ["CliLoc", [{"end": {"col": 58, "line": 21, "offset": 303}, "path": "/root/code/vulpy/bad/brute.py", "start": {"col": 29, "line": 21, "offset": 274}}, "[program, username, password]"]], "taint_source": ["CliLoc", [{"end": {"col": 20, "line": 7, "offset": 95}, "path": "/root/code/vulpy/bad/brute.py", "start": {"col": 12, "line": 7, "offset": 87}}, "sys.argv"]]}, "engine_kind": "OSS", "fingerprint": "ddb27137185aca11e5e4b50360e1b91fb35d8ec4dbf3a0e4638693e6eed0d16abc74ddf289766499237a0163d122e37040d2882dc1f7a6858fe21bc7b9adf7bb_0", "is_ignored": false, "lines": "    result = subprocess.run([program, username, password], stdout=subprocess.DEVNULL)", "message": "Detected subprocess function 'run' with user controlled data. A malicious actor could leverage this to perform command injection. You may consider using 'shlex.escape()'.", "metadata": {"asvs": {"control_id": "5.3.8 OS Command Injection", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "likelihood": "MEDIUM", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess", "https://docs.python.org/3/library/subprocess.html", "https://docs.python.org/3/library/shlex.html", "https://semgrep.dev/docs/cheat-sheets/python-command-injection/"], "subcategory": ["vuln"], "technology": ["python"]}, "metavars": {"$CMD": {"abstract_content": "[program username password]", "end": {"col": 58, "line": 21, "offset": 303}, "start": {"col": 29, "line": 21, "offset": 274}}, "$FUNC": {"abstract_content": "run", "end": {"col": 28, "line": 21, "offset": 273}, "start": {"col": 25, "line": 21, "offset": 270}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/brute.py", "start": {"col": 29, "line": 21, "offset": 274}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.insecure-transport.requests.request-with-http", "end": {"col": 74, "line": 10, "offset": 205}, "extra": {"dataflow_trace": {"taint_sink": ["CliLoc", [{"end": {"col": 74, "line": 10, "offset": 205}, "path": "/root/code/vulpy/bad/api_list.py", "start": {"col": 22, "line": 10, "offset": 153}}, "'http://127.0.1.1:5000/api/post/{}'.format(username)"]], "taint_source": ["CliLoc", [{"end": {"col": 57, "line": 10, "offset": 188}, "path": "/root/code/vulpy/bad/api_list.py", "start": {"col": 22, "line": 10, "offset": 153}}, "'http://127.0.1.1:5000/api/post/{}'"]]}, "engine_kind": "OSS", "fingerprint": "0a73e412204af6da445610d9b032b7f057df8d93e41695e60d548742ab111c8f78f02ab3b22cda148ce4b8f594173d7e2cd2d1b892ad9c1a667d7bb156d8a092_0", "fix_regex": {"count": 1, "regex": "[Hh][Tt][Tt][Pp]://", "replacement": "https://"}, "is_ignored": false, "lines": "    r = requests.get('http://127.0.1.1:5000/api/post/{}'.format(username))", "message": "Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.", "metadata": {"asvs": {"control_id": "9.1.1 Weak TLS", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements", "section": "V9 Communications Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["requests"]}, "metavars": {"$SINK": {"abstract_content": "'http://127.0.1.1:5000/api/post/{}'.format(username)", "end": {"col": 74, "line": 10, "offset": 205}, "start": {"col": 22, "line": 10, "offset": 153}}, "$URL": {"abstract_content": "http://127.0.1.1:5000/api/post/{}", "end": {"col": 56, "line": 10, "offset": 187}, "start": {"col": 23, "line": 10, "offset": 154}}, "$W": {"abstract_content": "get", "end": {"col": 21, "line": 10, "offset": 152}, "start": {"col": 18, "line": 10, "offset": 149}}}, "severity": "INFO"}, "path": "/root/code/vulpy/bad/api_list.py", "start": {"col": 22, "line": 10, "offset": 153}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.insecure-transport.requests.request-with-http", "end": {"col": 58, "line": 16, "offset": 372}, "extra": {"dataflow_trace": {"taint_sink": ["CliLoc", [{"end": {"col": 58, "line": 16, "offset": 372}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 27, "line": 16, "offset": 341}}, "'http://127.0.1.1:5000/api/key'"]], "taint_source": ["CliLoc", [{"end": {"col": 58, "line": 16, "offset": 372}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 27, "line": 16, "offset": 341}}, "'http://127.0.1.1:5000/api/key'"]]}, "engine_kind": "OSS", "fingerprint": "624a83268131e62c18477216bd4de935ed587d68badb0f4902703c5fe72cd9cf44f4301849871df177b076f670bffd06f9e8bcaf9d3aab735e0b75e3c2f45aaa_0", "fix_regex": {"count": 1, "regex": "[Hh][Tt][Tt][Pp]://", "replacement": "https://"}, "is_ignored": false, "lines": "        r = requests.post('http://127.0.1.1:5000/api/key', json={'username':username, 'password':password})", "message": "Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.", "metadata": {"asvs": {"control_id": "9.1.1 Weak TLS", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements", "section": "V9 Communications Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["requests"]}, "metavars": {"$SINK": {"abstract_content": "'http://127.0.1.1:5000/api/key'", "end": {"col": 58, "line": 16, "offset": 372}, "start": {"col": 27, "line": 16, "offset": 341}}, "$URL": {"abstract_content": "http://127.0.1.1:5000/api/key", "end": {"col": 57, "line": 16, "offset": 371}, "start": {"col": 28, "line": 16, "offset": 342}}, "$W": {"abstract_content": "post", "end": {"col": 26, "line": 16, "offset": 340}, "start": {"col": 22, "line": 16, "offset": 336}}}, "severity": "INFO"}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 27, "line": 16, "offset": 341}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.insecure-transport.requests.request-with-http", "end": {"col": 55, "line": 30, "offset": 849}, "extra": {"dataflow_trace": {"taint_sink": ["CliLoc", [{"end": {"col": 55, "line": 30, "offset": 849}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 23, "line": 30, "offset": 817}}, "'http://127.0.1.1:5000/api/post'"]], "taint_source": ["CliLoc", [{"end": {"col": 55, "line": 30, "offset": 849}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 23, "line": 30, "offset": 817}}, "'http://127.0.1.1:5000/api/post'"]]}, "engine_kind": "OSS", "fingerprint": "35272631f2efc91a64a73ef21bc22abfcd413c60df8b71fea6edeee2ff3873eb8a71724bacf0981f9b5f656d04f4eb39663cb0c019aaff614ba71f66f48b9eae_0", "fix_regex": {"count": 1, "regex": "[Hh][Tt][Tt][Pp]://", "replacement": "https://"}, "is_ignored": false, "lines": "    r = requests.post('http://127.0.1.1:5000/api/post', json={'text':message}, headers={'X-APIKEY': api_key})", "message": "Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.", "metadata": {"asvs": {"control_id": "9.1.1 Weak TLS", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements", "section": "V9 Communications Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["requests"]}, "metavars": {"$SINK": {"abstract_content": "'http://127.0.1.1:5000/api/post'", "end": {"col": 55, "line": 30, "offset": 849}, "start": {"col": 23, "line": 30, "offset": 817}}, "$URL": {"abstract_content": "http://127.0.1.1:5000/api/post", "end": {"col": 54, "line": 30, "offset": 848}, "start": {"col": 24, "line": 30, "offset": 818}}, "$W": {"abstract_content": "post", "end": {"col": 22, "line": 30, "offset": 816}, "start": {"col": 18, "line": 30, "offset": 812}}}, "severity": "INFO"}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 23, "line": 30, "offset": 817}}, {"check_id": "scanner_code.scanner_rules.lang.security.audit.insecure-transport.requests.request-with-http", "end": {"col": 33, "line": 22, "offset": 298}, "extra": {"dataflow_trace": {"taint_sink": ["CliLoc", [{"end": {"col": 33, "line": 22, "offset": 298}, "path": "/root/code/vulpy/good/httpbrute.py", "start": {"col": 30, "line": 22, "offset": 295}}, "URL"]], "taint_source": ["CliLoc", [{"end": {"col": 33, "line": 22, "offset": 298}, "path": "/root/code/vulpy/good/httpbrute.py", "start": {"col": 30, "line": 22, "offset": 295}}, "URL"]]}, "engine_kind": "OSS", "fingerprint": "41863b28fdfee982bbce2ee700945a7fb08709e3ef59b39c96d10d7144ec7067c9b435a264c8673ab0a7b90c0ad3ddab72f29bac55732704c44f62e4a8ee6bb3_0", "fix_regex": {"count": 1, "regex": "[Hh][Tt][Tt][Pp]://", "replacement": "https://"}, "is_ignored": false, "lines": "    response = requests.post(URL, data = {'username': username, 'password': password})", "message": "Detected a request using 'http://'. This request will be unencrypted, and attackers could listen into traffic on the network and be able to obtain sensitive information. Use 'https://' instead.", "metadata": {"asvs": {"control_id": "9.1.1 Weak TLS", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communications-security-requirements", "section": "V9 Communications Verification Requirements", "version": "4"}, "category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "LOW", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["requests"]}, "metavars": {"$SINK": {"abstract_content": "URL", "end": {"col": 33, "line": 22, "offset": 298}, "propagated_value": {"svalue_abstract_content": "'http://127.0.1.1:5000/user/login'", "svalue_end": {"col": 41, "line": 5, "offset": 81}, "svalue_start": {"col": 7, "line": 5, "offset": 47}}, "start": {"col": 30, "line": 22, "offset": 295}}, "$URL": {"abstract_content": "http://127.0.1.1:5000/user/login", "end": {"col": 40, "line": 5, "offset": 80}, "start": {"col": 8, "line": 5, "offset": 48}}, "$W": {"abstract_content": "post", "end": {"col": 29, "line": 22, "offset": 294}, "start": {"col": 25, "line": 22, "offset": 290}}}, "severity": "INFO"}, "path": "/root/code/vulpy/good/httpbrute.py", "start": {"col": 30, "line": 22, "offset": 295}}, {"check_id": "scanner_code.scanner_rules.lang.maintainability.code-after-unconditional-return", "end": {"col": 30, "line": 87, "offset": 2621}, "extra": {"engine_kind": "OSS", "fingerprint": "25f89e729eb1eba4dc33022e23e64ec9b7ceca2bb613817ade1c0931765d0dbfb68c374a2a109309bdc405f0db856441d279261ee1fc7d763508c66155b5cdb1_0", "is_ignored": false, "lines": "    return redirect('/')\n    flash(\"Password changed\")", "message": "code after return statement will not be executed", "metadata": {"category": "maintainability", "technology": ["python"]}, "metavars": {"$S": {"abstract_content": "flash(\"Password changed\")", "end": {"col": 30, "line": 87, "offset": 2621}, "start": {"col": 5, "line": 87, "offset": 2596}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/mod_user.py", "start": {"col": 5, "line": 86, "offset": 2571}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.unspecified-open-encoding", "end": {"col": 43, "line": 3, "offset": 53}, "extra": {"engine_kind": "OSS", "fingerprint": "753bc5abe4a329233b443244330e05440dc5e8741beb401387dc38582a1ef819ba1d1a7f44ffecafe55a18f81dd98a8c86c94c2949e8177f96c1f5250a2a55b7_0", "is_ignored": false, "lines": "with open('/tmp/darkweb2017-top10000.txt') as f:", "message": "Missing 'encoding' parameter. 'open()' uses device locale encodings by default, corrupting files with special characters. Specify the encoding to ensure cross-platform support when opening files in text mode (e.g. encoding=\"utf-8\").", "metadata": {"category": "best-practice", "references": ["https://www.python.org/dev/peps/pep-0597/", "https://docs.python.org/3/library/functions.html#open"], "technology": ["python"]}, "metavars": {"$FILE": {"abstract_content": "'/tmp/darkweb2017-top10000.txt'", "end": {"col": 42, "line": 3, "offset": 52}, "start": {"col": 11, "line": 3, "offset": 21}}}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/cutpasswd.py", "start": {"col": 6, "line": 3, "offset": 16}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 43, "line": 3, "offset": 53}, "extra": {"engine_kind": "OSS", "fingerprint": "b5ed26e03b3f5f3f2e1379dedf76f2dfebd92799576c88dda8d3a5348096600f540ba6f357d9b284a22a8e794363f0200c271ad76b0e3daf304d1f971d7c7ce0_0", "is_ignored": false, "lines": "with open('/tmp/darkweb2017-top10000.txt') as f:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/cutpasswd.py", "start": {"col": 6, "line": 3, "offset": 16}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 31, "line": 31, "offset": 863}, "extra": {"engine_kind": "OSS", "fingerprint": "84bb7d7c53ae1acb36c0bb2a6323983f3ff97bd2fb19bb33d62a108152357dc5d4ab7bdf397c1d96a3aa75b20ce6c85ae545377d6a1d5779120455d4f5e1468b_0", "is_ignored": false, "lines": "with open('/tmp/ca.key', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-create.py", "start": {"col": 6, "line": 31, "offset": 838}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 31, "line": 34, "offset": 930}, "extra": {"engine_kind": "OSS", "fingerprint": "84bb7d7c53ae1acb36c0bb2a6323983f3ff97bd2fb19bb33d62a108152357dc5d4ab7bdf397c1d96a3aa75b20ce6c85ae545377d6a1d5779120455d4f5e1468b_1", "is_ignored": false, "lines": "with open('/tmp/ca.pub', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-create.py", "start": {"col": 6, "line": 34, "offset": 905}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 32, "line": 58, "offset": 1948}, "extra": {"engine_kind": "OSS", "fingerprint": "84bb7d7c53ae1acb36c0bb2a6323983f3ff97bd2fb19bb33d62a108152357dc5d4ab7bdf397c1d96a3aa75b20ce6c85ae545377d6a1d5779120455d4f5e1468b_2", "is_ignored": false, "lines": "with open('/tmp/ca.cert', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-create.py", "start": {"col": 6, "line": 58, "offset": 1922}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 12, "offset": 368}, "extra": {"engine_kind": "OSS", "fingerprint": "c11694964443c8751551ad5e819d7498bcf202714d9d3a8b7845e55836dfb8915bf7fdc4d692d43b3d9bb142508fcbb8bb19e88bad950a3385303f1cf0e05e11_0", "is_ignored": false, "lines": "with open(\"/tmp/acme.key\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-create.py", "start": {"col": 6, "line": 12, "offset": 341}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 35, "offset": 1142}, "extra": {"engine_kind": "OSS", "fingerprint": "c11694964443c8751551ad5e819d7498bcf202714d9d3a8b7845e55836dfb8915bf7fdc4d692d43b3d9bb142508fcbb8bb19e88bad950a3385303f1cf0e05e11_1", "is_ignored": false, "lines": "with open(\"/tmp/acme.csr\", \"wb\") as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-create.py", "start": {"col": 6, "line": 35, "offset": 1115}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 32, "line": 13, "offset": 368}, "extra": {"engine_kind": "OSS", "fingerprint": "c93ee6c3e47ca5de8454a8bef9c64128e6c0ef892015a2ddd80213835ccdac1aabf059ac00f7492fb5e32130255d4f93af9a2bce10bf4a6126e97569fc1fb803_0", "is_ignored": false, "lines": "with open(\"/tmp/ca.cert\", \"rb\") as ca_cert_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-load.py", "start": {"col": 6, "line": 13, "offset": 342}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 16, "offset": 504}, "extra": {"engine_kind": "OSS", "fingerprint": "c93ee6c3e47ca5de8454a8bef9c64128e6c0ef892015a2ddd80213835ccdac1aabf059ac00f7492fb5e32130255d4f93af9a2bce10bf4a6126e97569fc1fb803_1", "is_ignored": false, "lines": "with open(\"/tmp/acme.csr\", \"rb\") as csr_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-load.py", "start": {"col": 6, "line": 16, "offset": 477}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 31, "line": 19, "offset": 618}, "extra": {"engine_kind": "OSS", "fingerprint": "c93ee6c3e47ca5de8454a8bef9c64128e6c0ef892015a2ddd80213835ccdac1aabf059ac00f7492fb5e32130255d4f93af9a2bce10bf4a6126e97569fc1fb803_2", "is_ignored": false, "lines": "with open(\"/tmp/ca.key\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-load.py", "start": {"col": 6, "line": 19, "offset": 593}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 34, "line": 35, "offset": 1251}, "extra": {"engine_kind": "OSS", "fingerprint": "c93ee6c3e47ca5de8454a8bef9c64128e6c0ef892015a2ddd80213835ccdac1aabf059ac00f7492fb5e32130255d4f93af9a2bce10bf4a6126e97569fc1fb803_3", "is_ignored": false, "lines": "with open('/tmp/acme.cert', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/ca-csr-load.py", "start": {"col": 6, "line": 35, "offset": 1223}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 14, "offset": 373}, "extra": {"engine_kind": "OSS", "fingerprint": "469c3c618bf7d93ced8c1eded85e5f11fda0375a6fa22448ee26b1977d454a93a70df90af74965f0f12189f2c75f818a1fc9731c233170398a4276ac673b9a5d_0", "is_ignored": false, "lines": "with open(\"/tmp/acme.key\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-decrypt.py", "start": {"col": 6, "line": 14, "offset": 346}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 14, "offset": 353}, "extra": {"engine_kind": "OSS", "fingerprint": "2f09c10634094c18ab5c8ac63e4ed64a786115620be125443d2f6baa91c5bc95c9af0e6f7b6ef1a439c742a175222e6521410c89393d0596ca0613a2a512a459_0", "is_ignored": false, "lines": "with open(\"/tmp/acme.pub\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-encrypt.py", "start": {"col": 6, "line": 14, "offset": 326}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 26, "offset": 726}, "extra": {"engine_kind": "OSS", "fingerprint": "bbd4b0160de3be3ea13d1b8d31e7b5afea8f2fef1c3b8f124599789e061f0f0a7fdf5e8f9f6639f22cabf63ce7ff08481d0adbf1e06512f6ba9a37026cdb197d_0", "is_ignored": false, "lines": "with open('/tmp/acme.key', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-keygen.py", "start": {"col": 6, "line": 26, "offset": 699}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 29, "offset": 795}, "extra": {"engine_kind": "OSS", "fingerprint": "bbd4b0160de3be3ea13d1b8d31e7b5afea8f2fef1c3b8f124599789e061f0f0a7fdf5e8f9f6639f22cabf63ce7ff08481d0adbf1e06512f6ba9a37026cdb197d_1", "is_ignored": false, "lines": "with open('/tmp/acme.pub', 'wb') as out:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-keygen.py", "start": {"col": 6, "line": 29, "offset": 768}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 15, "offset": 413}, "extra": {"engine_kind": "OSS", "fingerprint": "232891cd2d8e0b6e943e1dab61790016f96ac3826107f3a8f67248321129c01d42c236b71d91487e17b67f54c844ad9255016fc47812f1e0b2d11a039eb451c3_0", "is_ignored": false, "lines": "with open(\"/tmp/acme.key\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-sign.py", "start": {"col": 6, "line": 15, "offset": 386}}, {"check_id": "scanner_code.scanner_rules.lang.best-practice.hardcoded-tmp-path", "end": {"col": 33, "line": 16, "offset": 443}, "extra": {"engine_kind": "OSS", "fingerprint": "1d84e4b26461b72ebb0f6f81721c46b8c2300f4ddc87af297743d5298cdd8ffcab3360dc82bb416045acbdb9510166d188df650c6c8fa3c7f20a0d8738e7f578_0", "is_ignored": false, "lines": "with open(\"/tmp/acme.pub\", \"rb\") as key_file:", "message": "Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.", "metadata": {"category": "best-practice", "references": ["https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile"], "technology": ["python"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/rsa-verify.py", "start": {"col": 6, "line": 16, "offset": 416}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 103, "line": 19, "offset": 549}, "extra": {"engine_kind": "OSS", "fingerprint": "a79ff73317642f94ce8083cde11d944df5b033cec524b68bc3f82c7da5818e9f05ec2a2d03892698d49258b344554eb8c8afbc5a223ab908e0d84382646de07c_0", "is_ignored": false, "lines": "        c.execute(\"INSERT INTO users (user, password, failures) VALUES ('%s', '%s', '%d')\" %(u, p, 0))", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 10, "line": 19, "offset": 456}, "start": {"col": 9, "line": 19, "offset": 455}}, "$SQL": {"abstract_content": "\"INSERT INTO users (user, password, failures) VALUES ('%s', '%s', '%d')\"", "end": {"col": 91, "line": 19, "offset": 537}, "start": {"col": 19, "line": 19, "offset": 465}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/db.py", "start": {"col": 9, "line": 19, "offset": 455}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 151, "line": 20, "offset": 545}, "extra": {"engine_kind": "OSS", "fingerprint": "45fd37a55e239ccd28ec5f1ef16563ba7dd778e352f36d7bb31a955cafe431e3f78557714401abd73b8c7b12d83d6188440c2fcd0bb81acce7bafdc6f4dce88c_0", "is_ignored": false, "lines": "        c.execute(\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\" %(u, p, 0, 0, ''))", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 10, "line": 20, "offset": 404}, "start": {"col": 9, "line": 20, "offset": 403}}, "$SQL": {"abstract_content": "\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\"", "end": {"col": 132, "line": 20, "offset": 526}, "start": {"col": 19, "line": 20, "offset": 413}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/db_init.py", "start": {"col": 9, "line": 20, "offset": 403}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 113, "line": 12, "offset": 315}, "extra": {"engine_kind": "OSS", "fingerprint": "0471595fa0224aabaea6207a7b953b671c0468543951bf58ae34aa4d2470b2446f11907e857266bfac282b31081f6b0122a6562073cc132ebe5e4bbd5335e80e_0", "is_ignored": false, "lines": "    user = c.execute(\"SELECT * FROM users WHERE username = '{}' and password = '{}'\".format(username, password)).fetchone()", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 13, "line": 12, "offset": 215}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 10, "offset": 201}, "svalue_start": {"col": 9, "line": 10, "offset": 188}}, "start": {"col": 12, "line": 12, "offset": 214}}, "$SQL": {"abstract_content": "\"SELECT * FROM users WHERE username = '{}' and password = '{}'\"", "end": {"col": 85, "line": 12, "offset": 287}, "start": {"col": 22, "line": 12, "offset": 224}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 12, "line": 12, "offset": 214}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 161, "line": 25, "offset": 668}, "extra": {"engine_kind": "OSS", "fingerprint": "3ca65cee2245d010b5113b9e9db18d4f786165581623047b0ba37cf7b68668bcb5d07001fab1b226b059cfa27020c6143ef1ae1a1f869f6dd38ad10e2309fc8d_0", "is_ignored": false, "lines": "    c.execute(\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\" %(username, password, 0, 0, ''))", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 6, "line": 25, "offset": 513}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 23, "offset": 506}, "svalue_start": {"col": 9, "line": 23, "offset": 493}}, "start": {"col": 5, "line": 25, "offset": 512}}, "$SQL": {"abstract_content": "\"INSERT INTO users (username, password, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%d', '%d', '%s')\"", "end": {"col": 128, "line": 25, "offset": 635}, "start": {"col": 15, "line": 25, "offset": 522}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 5, "line": 25, "offset": 512}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 99, "line": 53, "offset": 1301}, "extra": {"engine_kind": "OSS", "fingerprint": "01b0bb685a340bf9000ab69e7ca6e4d833fbb2193e18fa3e331fda09584cb80c332c0a8e88644f736404105dffca82eaf33c74c06f9af58b8e4b78fa4cfe4bfb_0", "is_ignored": false, "lines": "    c.execute(\"UPDATE users SET password = '{}' WHERE username = '{}'\".format(password, username))", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 6, "line": 53, "offset": 1208}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 51, "offset": 1201}, "svalue_start": {"col": 9, "line": 51, "offset": 1188}}, "start": {"col": 5, "line": 53, "offset": 1207}}, "$SQL": {"abstract_content": "\"UPDATE users SET password = '{}' WHERE username = '{}'\"", "end": {"col": 71, "line": 53, "offset": 1273}, "start": {"col": 15, "line": 53, "offset": 1217}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/bad/libuser.py", "start": {"col": 5, "line": 53, "offset": 1207}}, {"check_id": "scanner_code.scanner_rules.sqlalchemy.security.sqlalchemy-execute-raw-query", "end": {"col": 171, "line": 61, "offset": 1523}, "extra": {"engine_kind": "OSS", "fingerprint": "667c33ffc71bdc3a3200b27dcf0a766607d645d72cd97e880d3b4b9b07ff10e32d2cb8eeef880a5867cedaa4a146b18012eb784b23ed8bec56d7f8f298cffc6f_0", "is_ignored": false, "lines": "    c.execute(\"INSERT INTO users (username, password, salt, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%s', '%d', '%d', '%s')\" %(username, '', '', 0, 0, ''))", "message": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql", "https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm", "https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"], "subcategory": ["audit"], "technology": ["sqlalchemy"]}, "metavars": {"$CONNECTION": {"abstract_content": "c", "end": {"col": 6, "line": 61, "offset": 1358}, "propagated_value": {"svalue_abstract_content": "conn.cursor()", "svalue_end": {"col": 22, "line": 60, "offset": 1352}, "svalue_start": {"col": 9, "line": 60, "offset": 1339}}, "start": {"col": 5, "line": 61, "offset": 1357}}, "$SQL": {"abstract_content": "\"INSERT INTO users (username, password, salt, failures, mfa_enabled, mfa_secret) VALUES ('%s', '%s', '%s', '%d', '%d', '%s')\"", "end": {"col": 140, "line": 61, "offset": 1492}, "start": {"col": 15, "line": 61, "offset": 1367}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/good/libuser.py", "start": {"col": 5, "line": 61, "offset": 1357}}, {"check_id": "scanner_code.scanner_rules.cryptography.security.crypto-mode-without-authentication", "end": {"col": 101, "line": 24, "offset": 630}, "extra": {"engine_kind": "OSS", "fingerprint": "1ea7c481af1b1ceded9a4ed9a6c9932924592513a9a666f039a24c06efdc7a6e1b400cb21fe8a4d9090df9cef482e4c833ba1049ecd192d01c7e2ee1b4622c9d_0", "is_ignored": false, "lines": "    cipher = Cipher(algorithms.AES(key_digest), modes.CFB(unhexlify(iv)), backend=default_backend())", "message": "An encryption mode of operation is being used without proper message authentication. This can potentially result in the encrypted content to be decrypted by an attacker. Consider instead use an AEAD mode of operation like GCM. ", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-327: Use of a Broken or Risky Cryptographic Algorithm"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["cryptography"]}, "metavars": {"$HAZMAT_MODE": {"abstract_content": "modes.CFB", "end": {"col": 58, "line": 24, "offset": 587}, "start": {"col": 49, "line": 24, "offset": 578}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/utils/aes-decrypt.py", "start": {"col": 14, "line": 24, "offset": 543}}, {"check_id": "scanner_code.scanner_rules.cryptography.security.crypto-mode-without-authentication", "end": {"col": 90, "line": 28, "offset": 692}, "extra": {"engine_kind": "OSS", "fingerprint": "71417c29dbe0e9f786803516ad3020760b7ed881fa270dbdd1d7a61137fa0ab5ccd85a4a7c53ce352d368fc9e62bd4792df9ddf34e5c3deff5846bcbb6233832_0", "is_ignored": false, "lines": "    cipher = Cipher(algorithms.AES(key_digest), modes.CFB(iv), backend=default_backend())", "message": "An encryption mode of operation is being used without proper message authentication. This can potentially result in the encrypted content to be decrypted by an attacker. Consider instead use an AEAD mode of operation like GCM. ", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-327: Use of a Broken or Risky Cryptographic Algorithm"], "impact": "MEDIUM", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "subcategory": ["audit"], "technology": ["cryptography"]}, "metavars": {"$HAZMAT_MODE": {"abstract_content": "modes.CFB", "end": {"col": 58, "line": 28, "offset": 660}, "start": {"col": 49, "line": 28, "offset": 651}}}, "severity": "ERROR"}, "path": "/root/code/vulpy/utils/aes-encrypt.py", "start": {"col": 14, "line": 28, "offset": 616}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-raise-for-status", "end": {"col": 110, "line": 30, "offset": 904}, "extra": {"engine_kind": "OSS", "fingerprint": "774a17be34a20e83a473cffa21330f9a32fcd59559ff1ce6af75787d733a0801fb664353a9d931539d16582c7a3ea3a91ba456ebfffc51055ebbee04d9072336_0", "is_ignored": false, "lines": "    r = requests.post('http://127.0.1.1:5000/api/post', json={'text':message}, headers={'X-APIKEY': api_key})", "message": "There's an HTTP request made with requests, but the raise_for_status() utility method isn't used. This can result in request errors going unnoticed and your code behaving in unexpected ways, such as if your authorization API returns a 500 error while you're only checking for a 401.", "metadata": {"category": "best-practice", "references": ["https://requests.readthedocs.io/en/master/api/#requests.Response.raise_for_status"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 9, "line": 30, "offset": 803}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-raise-for-status", "end": {"col": 87, "line": 22, "offset": 352}, "extra": {"engine_kind": "OSS", "fingerprint": "087f7412eb5a95c7bc4b8e85149508b02a3e1a6862233897271d0d3f8cf8568050d8999b8115501d4d46443c35721b8be51e1858eae1fc410270bbb4eba643d2_0", "is_ignored": false, "lines": "    response = requests.post(URL, data = {'username': username, 'password': password})", "message": "There's an HTTP request made with requests, but the raise_for_status() utility method isn't used. This can result in request errors going unnoticed and your code behaving in unexpected ways, such as if your authorization API returns a 500 error while you're only checking for a 401.", "metadata": {"category": "best-practice", "references": ["https://requests.readthedocs.io/en/master/api/#requests.Response.raise_for_status"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/httpbrute.py", "start": {"col": 16, "line": 22, "offset": 281}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-raise-for-status", "end": {"col": 40, "line": 21, "offset": 776}, "extra": {"engine_kind": "OSS", "fingerprint": "c0c5131014b4b3f38e5b8a7bd5b798fcd1157b6e2be9e06119e61d3947bca7f38a1b8836fe485d595e3c2298490e4759b43c6d0cff957d50c17f0517ad791000_0", "is_ignored": false, "lines": "    with requests.get(url, stream=True) as r:", "message": "There's an HTTP request made with requests, but the raise_for_status() utility method isn't used. This can result in request errors going unnoticed and your code behaving in unexpected ways, such as if your authorization API returns a 500 error while you're only checking for a 401.", "metadata": {"category": "best-practice", "references": ["https://requests.readthedocs.io/en/master/api/#requests.Response.raise_for_status"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/generate_bad_passwords.py", "start": {"col": 10, "line": 21, "offset": 746}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-raise-for-status", "end": {"col": 91, "line": 25, "offset": 700}, "extra": {"engine_kind": "OSS", "fingerprint": "a8f492df03f12eb23513e7e62128f3ee4d8896371600694dec2322b8b0dab2ddef0c87d6945495349e3802bf0e4c284ebe922c16ffc3978ec7746f6cb218bef5_0", "is_ignored": false, "lines": "        response = requests.post(url, data = {'username': username, 'password': password})", "message": "There's an HTTP request made with requests, but the raise_for_status() utility method isn't used. This can result in request errors going unnoticed and your code behaving in unexpected ways, such as if your authorization API returns a 500 error while you're only checking for a 401.", "metadata": {"category": "best-practice", "references": ["https://requests.readthedocs.io/en/master/api/#requests.Response.raise_for_status"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/httpbrute.py", "start": {"col": 20, "line": 25, "offset": 629}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 75, "line": 10, "offset": 206}, "extra": {"engine_kind": "OSS", "fingerprint": "6bdf310e20ac6e4cbda121faff7782618786ae1300da4be5bf45034e1762e44e6250dec2eb556858590fb31277a95f2a007eb293333a7c01ac0ef0aae84ebe8c_0", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "    r = requests.get('http://127.0.1.1:5000/api/post/{}'.format(username))", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/api_list.py", "start": {"col": 9, "line": 10, "offset": 140}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 108, "line": 16, "offset": 422}, "extra": {"engine_kind": "OSS", "fingerprint": "3e6e23645aaec18ac791790798f9ddf96c89bbbef90aa10c32f532129da8988f8193f8c27b5b490debd85cda10a3dc0de52559789bf5fa82314209fd73235cfd_0", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "        r = requests.post('http://127.0.1.1:5000/api/key', json={'username':username, 'password':password})", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 13, "line": 16, "offset": 327}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 110, "line": 30, "offset": 904}, "extra": {"engine_kind": "OSS", "fingerprint": "3e6e23645aaec18ac791790798f9ddf96c89bbbef90aa10c32f532129da8988f8193f8c27b5b490debd85cda10a3dc0de52559789bf5fa82314209fd73235cfd_1", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "    r = requests.post('http://127.0.1.1:5000/api/post', json={'text':message}, headers={'X-APIKEY': api_key})", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/bad/api_post.py", "start": {"col": 9, "line": 30, "offset": 803}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 87, "line": 22, "offset": 352}, "extra": {"engine_kind": "OSS", "fingerprint": "b871909cca8b86c9355f9d9c0462922e5758cccfd7c104d2c83d21193ccc0a85c3feef3b20f3c29c80aaec79986ff3a59260d8bf3bfb6464d9a3c8fd74363808_0", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "    response = requests.post(URL, data = {'username': username, 'password': password})", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/good/httpbrute.py", "start": {"col": 16, "line": 22, "offset": 281}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 40, "line": 21, "offset": 776}, "extra": {"engine_kind": "OSS", "fingerprint": "5910327e296193df90b07e48cba90bca7037f5f13a24d274f1dc1cc20aa34b42b5a0c3b8546f9b9cdb121e56e8ac8620b3717f099895aa8edf370be141e4fe01_0", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "    with requests.get(url, stream=True) as r:", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/generate_bad_passwords.py", "start": {"col": 10, "line": 21, "offset": 746}}, {"check_id": "scanner_code.scanner_rules.requests.best-practice.use-timeout", "end": {"col": 91, "line": 25, "offset": 700}, "extra": {"engine_kind": "OSS", "fingerprint": "62a8e1190e548334ae0132f4fdae953a9982ed551665dbf3f761627105e3add93ec0abd85f62bdeca8efcd97cbcaf278afdbd48489eabdc25dd17a7473137d5e_0", "fix_regex": {"regex": "(.*)\\)$", "replacement": "\\1, timeout=30)"}, "is_ignored": false, "lines": "        response = requests.post(url, data = {'username': username, 'password': password})", "message": "Detected a 'requests' call without a timeout set. By default, 'requests' calls wait until the connection is closed. This means a 'requests' call without a timeout will hang the program if a response is never received. Consider setting a timeout for all 'requests'.", "metadata": {"category": "best-practice", "references": ["https://docs.python-requests.org/en/latest/user/advanced/?highlight=timeout#timeouts", "https://requests.readthedocs.io/en/latest/user/quickstart/#timeouts"], "technology": ["requests"]}, "metavars": {}, "severity": "WARNING"}, "path": "/root/code/vulpy/utils/httpbrute.py", "start": {"col": 20, "line": 25, "offset": 629}}], "version": "1.34.1"}
