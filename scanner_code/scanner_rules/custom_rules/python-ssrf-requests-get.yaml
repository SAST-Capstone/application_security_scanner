rules:
- id: python-ssrf-requests-get
  patterns:
    - pattern-either:
        - pattern: requests.get($URL, ...)
        - pattern: requests.post($URL, ...)
        - pattern: requests.put($URL, ...)
        - pattern: requests.delete($URL, ...)
        - pattern: requests.head($URL, ...)
        - pattern: requests.options($URL, ...)
        - pattern: requests.patch($URL, ...)
    - pattern-not-inside: |
        def $FUNC(...):
            ...
            $URL = "http://..."
            ...
            requests.get($URL, ...)
  message: "SSRF potential via requests method with user input"
  languages: [python]
  severity: WARNING
  fix: |
    Ensure that $URL is not directly controlled by user input, or if it must be,
    implement strict input validation/sanitization and use allowlists for URLs.
