rules:
- id: python-code-injection-taint-analysis
  mode: taint
  message: Unsanitized user input might be used in a risky function, leading to potential code injection.
  languages: [python]
  severity: ERROR
  pattern-sources:
    - pattern: flask.request.args.get(...)
    - pattern: flask.request.form.get(...)
    - pattern: flask.request.values.get(...)
    - pattern: request.GET.get(...)
    - pattern: request.POST.get(...)
    - pattern: request.values.get(...)
  pattern-sinks:
    - pattern: eval(...)
    - pattern: exec(...)
    - pattern: os.system(...)
    - pattern: subprocess.call(...)
    - pattern: subprocess.Popen(...)
  pattern-sanitizers:
    - pattern: $X.encode(...)
    - pattern: $X.decode(...)
    - pattern: html.escape(...)
    - pattern: re.escape(...)
    - pattern: sqlalchemy.text(...)
  pattern-propagators:
    - pattern: $X = $Y
    - pattern: return $X
